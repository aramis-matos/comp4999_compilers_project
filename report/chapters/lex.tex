\section{Gramatica del Lenguaje AVISMO}

\begin{itemize}
    \item <SENTENCIAS> ::= <FIN\_DE\_LINEA> <SENTENCIAS> | <SENTENCIA> <FIN\_DE\_LINEA>
    \item <FIN\_DE\_LINEA> ::= ":" | ";"
    \item <SENTENCIA> ::= "defina" <ID> "como" <TIPO> | <ID> "="  <MODELO\_MOLECULAR> | <OPERACION> "(" <ID> ")"
    \item <ID> ::= "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z" | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" | "y" | "z" | <LETRA> <IDCONT>
    \item <IDCONT> ::= "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z" | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" | "y" | "z" | <LETRA> <IDCONT> | "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" | <DIGITO> <IDCONT>
    \item <LETRA> ::= "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" | "I" | "J" | "K" | "L" | "M" | "N" | "O" | "P" | "Q" | "R" | "S" | "T" | "U" | "V" | "W" | "X" | "Y" | "Z" | "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" | "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" | "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" | "y" | "z"
    \item <DIGITO> ::= "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"
    \item <TIPO> ::= "modelo"
    \item <OPERACION> ::= "graficar2d" |"graficar3d" | "pesomolecular"
    \item <MODELO\_MOLECULAR> ::= "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn" | <ELEMENTO\_QUIMICO> <VALENCIA> | <ELEMENTO> <GRUPO\_FUNCIONAL> | <COMPUESTO> <ELEMENTO> <GRUPO\_FUNCIONAL> | <COMPUESTO> <COMPUESTO>
    \item <COMPUESTO> ::= "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn" | <ELEMENTO\_QUIMICO> <VALENCIA> | <ELEMENTO> <GRUPO\_FUNCIONAL> | <ELEMENTO> <GRUPO\_FUNCIONAL> <ENLACE> | <ELEMENTO> <ENLACE>
    \item <COMPUESTOS> ::= <COMPUESTO> <COMPUESTO> | <COMPUESTOS>
    \item <ELEMENTO> ::= "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn" | <ELEMENTO\_QUIMICO> <VALENCIA>
    \item <ELEMENTO\_QUIMICO> ::= "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn"
    \item <VALENCIA> ::= "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9"
    \item <GRUPO\_FUNCIONAL> ::=
          <GRUPO\_FUNCIONAL\_INFERIOR>

          <GRUPO\_FUNCIONAL\_SUPERIOR> | <GRUPO\_FUNCIONAL\_SUPERIOR> <GRUPO\_FUNCIONAL\_INFERIOR> | "(" <MODELO\_GRUPO\_FUNCIONAL> ")" | "["  <MODELO\_GRUPO\_FUNCIONAL> "]"
    \item <GRUPO\_FUNCIONAL\_SUPERIOR> ::= "[" <MODELO\_GRUPO\_FUNCIONAL> "]"
    \item <GRUPO\_FUNCIONAL\_INFERIOR> ::= "(" <MODELO\_GRUYPO\_FUNCIONAL> ")
    \item  <MODELO\_GRUYPO\_FUNCIONAL> ::= <ENLACE> <MODELO\_MOLECULAR> | "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn" | <ELEMENTO\_QUIMICO> <VALENCIA> | <ELEMENTO> <GRUPO\_FUNCIONAL> | <COMPUESTO> <ELEMENTO> | <COMPUESTO> <COMPUESTO> <COMPUESTOS>
\end{itemize}
\vspace{1cm}
En la tabla \ref{table:lexTable}, en la columna de patrones, note que cuando dice $\left\{\textit{TOKEN}\right\}$ donde \textit{TOKEN} se refiere a el patrón asociado a \textit{token}.
Por ejemplo, si un patrón dice $\left\{\textit{ELEMENTO\_QUIMICO}\right\}$, esto significa que inserta el patrón asociado al \textit{token} \textit{ELEMENTO\_QUIMICO}.
Esto no significa que el analizador léxico espera un \textit{token} de por si, sencillamente se hizo con el propósito de evitar redundancias.
\newpage

\begin{landscape}
    \footnotesize
    \begin{longtable}{| p{0.2\textheight} | p{0.75\textheight} | p{0.2\textheight} | p{0.25\textheight} |}
        \hline
        \textit{Token}                 & Patrón                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       & Lexema        & Atributos                                                              \\\hline
        <FIN\_DE\_LINEA>               & ; | :                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        & :             & Simbolo reservado                                                      \\\hline
        <PALABRA \_RESERVADA>          & defina | como                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                & defina        & Palabra reservada                                                      \\\hline
        <ID>                           & [A-Za-z][A-Za-z0-9]*                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         & var1          & Modelo molecular asociado                                              \\\hline
        <IDCONT>                       & \textit{[A-Za-z0-9]+}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        & 1ar           & ID asociado                                                            \\\hline
        <LETRA>                        & [A-Za-z]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     & a             & ID asociado                                                            \\\hline
        <DIGITO>                       & [0-9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        & 7             & Valor numérico, lexema asociado                                        \\\hline
        <TIPO>                         & modelo                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       & modelo        & ID asociado                                                            \\\hline
        <OPERACION>                    & graficar2d | graficar3d | pesomolecular                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      & pesomolecular & ID asociado                                                            \\\hline
        <MODELO \_MOLECULAR>           & (\{ELEMENTO \_QUIMICO\} | \{ELEMENTO \_QUIMICO\} \{VALENCIA\} | \{ELEMENTO\} \{GRUPO \_FUNCIONAL\} | \{ELEMENTO\} \{GRUPO \_FUNCIONAL\} \{ENLACE\} | \{ELEMENTO\} \{ENLACE\})                                                                                                                                                                                                                                                                                                                                                                                & CH3(CH3)CHH   & ID asociado                                                            \\\hline
        <COMPUESTO>                    & COMPUESTO (\{ELEMENTO \_QUIMICO\} | \{ELEMENTO \_QUIMICO\} \{VALENCIA\} | \{ELEMENTO\} \{GRUPO\_FUNCIONAL\} | \{ELEMENTO\} \{GRUPO \_FUNCIONAL\} \{ENLACE\} | \{ELEMENTO\} \{ENLACE\})                                                                                                                                                                                                                                                                                                                                                                       & CH3::         & Modelo molecular asociado, enlaces, valencias                          \\\hline
        <COMPUESTOS>                   & \{COMPUESTO\}+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               & CH3::(OH)3    & Modelo molecular asociado, enlaces, valencias                          \\\hline
        <ELEMENTO>                     & \{ELEMENTO \_QUIMICO\} \{VALENCIA\}?                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         & Ag3           & Elemento, valencia                                                     \\\hline
        <ELEMENTO \_QUIMICO>           & ( "H" | "Li" | "Na" | "K" | "Rb" | "Cs" | "Fr" | "Be" | "Mg" | "Ca" | "Sr" | "Ba" | "Ra" | "Sc" | "Y" | "Ti" | "Zr" | "Hf" | "Db" | "V" | "Nb" | "Ta" | "Ji" | "Cr" | "Mo" | "W" | "Rf" | "Mn" | "Tc" | "Re" | "Bh" | "Fe" | "Ru" | "Os" | "Hn" | "Co" | "Rh" | "Ir" | "Mt" | "Ni" | "Pd" | "Pt" | "Cu" | "Ag" | "Au" | "Zn" | "Cd" | "Hg" | "B" | "Al" | "Ga" | "In" | "Ti" | "C" | "Si" | "Ge" | "Sn" | "Pb" | "N" | "P" | "As" | "Sb" | "Bi" | "O" | "S" | "Se" | "Te" | "Po" | "F" | "Cr" | "Br" | "I" | "At" | "He" | "Ne" | "Ar" | "Kr" | "Xe" | "Rn") & I             & Elemento                                                               \\\hline
        <VALENCIA>                     & [1-9]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        & 2             & Valor                                                                  \\\hline
        <GRUPO \_FUNCIONAL>            & ( \{GRUPO \_FUNCIONAL \_INFERIOR\} \{GRUPO \_FUNCIONAL \_SUPERIOR\} | \{GRUPO \_FUNCIONAL \_SUPERIOR\} \{GRUPO \_FUNCIONAL\_INFERIOR\} | "(" \{MODELO \_GRUPO \_FUNCIONAL\} ")" | "[" {MODELO \_GRUPO \_FUNCIONAL} "]")                                                                                                                                                                                                                                                                                                                                      & (CH3)\{Ag2\}  & Grupos funcionales, grupo funcional inferior, grupo funcional superior \\\hline
        <GRUPO \_FUNCIONAL \_INFERIOR> & "[" \{MODELO \_GRUPO \_FUNCIONAL\} "]"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       & [CVHe3]       & Elementos, valencias                                                   \\\hline
        <GRUPO \_FUNCIONAL \_SUPERIOR> & "(" \{MODELO \_GRUPO \_FUNCIONAL\} ")"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       & (CVHe3)       & Elementos, valencias                                                   \\\hline
        <MODELO \_GRUPO \_FUNCIONAL>   & (\{ELEMENTO \_QUIMICO\}+ \{VALENCIA\}?)+ | (\{ELEMENTO\}+ \{ENLACE\} \{ELEMENTO\}+)+                                                                                                                                                                                                                                                                                                                                                                                                                                                                         & FeH=C3Si4     & Elementos, enlaces, valencias                                          \\\hline
        <ENLACE>                       & ("-" | "=" | ":" | "::")                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     & -             & Valencia                                                               \\\hline
        \caption{Tabla de Componentes Léxicos de AVISMO}
        \label{table:lexTable}
    \end{longtable}
\end{landscape}

\section{Diseño del del Analizador Léxico}

\subsection{Autómatas Finitos Deterministas}

\begin{figure}[H]
    \footnotesize
    \begin{minipage}{.5\textwidth}
        \centering
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 2.5cm, on grid, auto]
                \node [state,initial] (q0) {$0$};
                \node [state,accepting] [right=of q0] (q1) {$1$};
                \node [state,accepting] [below=of q1] (q2) {$2$};

                \path[-stealth, thick]
                (q0) edge node {;} (q1)
                (q0) edge [bend right] node {:} (q2);
            \end{tikzpicture}
            \label{fig: finDeLineaAutomata}
        \end{mdframed}
        \caption{Automata del patrón para el token <FIN\_DE\_LINEA>}
    \end{minipage}\hspace{1cm}
    \begin{minipage}{0.5\textwidth}
        \centering
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 2.5cm, on grid, auto]
                \node [state, initial] (q0) {$0$};
                \node [state, accepting] [right=of q0] (q1) {$1$};
                \node [state, accepting] [below=of q1] {$1$};

                \path[-stealth, thick]
                (q0) edge node {defina} (q1)
                (q0) edge [bend right] node {como} (q2);
            \end{tikzpicture}
        \end{mdframed}
        \label{fig: palabraReservada}
        \captionof{figure}{Automata del patrón para el token <PALABRAS\_RESERVADA>}
    \end{minipage}
\end{figure}


\begin{figure}[H]
    \footnotesize
    \begin{minipage}{0.5\textwidth}
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 2.5cm, auto]
                \node [state, initial] (q0) {0};
                \node [state, accepting] [right=of q0] (q1) {$1$};
                \node [state] [below=of q0] (q2) {$2$};
                \node [state, accepting] [right=of q2] (q3) {$3$};

                \path[-stealth, thick]
                (q0) edge node {[A-Za-z]} (q1)
                (q0) edge node {<LETRA>} (q2)
                (q2) edge node {<IDCONT>} (q3);
            \end{tikzpicture}
        \end{mdframed}
        \label{fig: idAutomata}
        \caption{Automata del patrón para el token <ID>}
    \end{minipage}\hspace{1cm}
    \begin{minipage}{0.5\textwidth}
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 1.5cm, auto]
                \node [state, initial] (q0) {$0$};
                \node [state, accepting] [right=of q0] (q1) {$1$};
                \node [state] [below=of q1] (q2) {$2$};
                \node [state, accepting] [above left=of q0] (q4) {$4$};
                \node [state] [below left=of q0] (q5) {$5$};


                \path[-stealth, thick]
                (q0) edge node {[A-Za-z]} (q1)
                (q0) edge node [left] {<LETRA>} (q2)
                (q2) edge [bend right] node [right]{<IDCONT>} (q0)
                (q0) edge [bend right] node[right] {[0-9]} (q4)
                (q0) edge [bend right] node [left] {<DIGITO>} (q5)
                (q5.east) edge [bend right] node [below] {<IDCONT>} (q0);


            \end{tikzpicture}
        \end{mdframed}
        \label{fig: idContAutomata}
        \caption{Automata del patrón para el token <IDCONT>}
    \end{minipage}
\end{figure}

\begin{figure}[H]
    \footnotesize
    \begin{minipage}{0.5\textwidth}
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 1.5cm, on grid, auto]
                \node [state,initial] (q0) {$0$};
                \node [state,accepting] [right=of q1] (q1) {$1$};

                \path[-stealth,thick]
                (q0) edge node {=} (q1);
            \end{tikzpicture}
        \end{mdframed}
        \label{fig: asigAutomata}
        \caption{Automata del patrón para el token <ASIGNACION>}
    \end{minipage}\hspace{1cm}
    \begin{minipage}{0.5\linewidth}
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 0cm, on grid ,auto]
                \node [state,initial] (q0) {$0$};
                \node [state,accepting] [right=of q1] (q1) {$1$};

                \path[-stealth,thick]
                (q0) edge node {[0-9]} (q1);
            \end{tikzpicture}
        \end{mdframed}
        \label{fig: letraAutomata}
        \caption{Automata del patrón para el token <LETRA>}
    \end{minipage}
\end{figure}

\begin{center}
    \begin{figure}[H]
        \footnotesize
        \begin{mdframed}
            \begin{tikzpicture}[node distance = 0cm, on grid ,auto]
                \node [state,initial] (q0) {$0$};
                \node [state,accepting] [right=of q1] (q1) {$1$};

                \path[-stealth,thick]
                (q0) edge node {[0-9]} (q1);
            \end{tikzpicture}
        \end{mdframed}
        \label{fig: digitoAutomata}
        \caption{Automata del patrón para el token <DIGITO>}
    \end{figure}
\end{center}

\subsection{Tabla de Símbolos}

\begin{figure}[H]
    \begin{tikzpicture}[
            node distance=2cm and 3cm,
            ID/.style={rectangle, rounded corners, draw=black, thick, minimum size=10mm},
            ATT/.style={rectangle, rounded corners, draw=red!60, thick, minimum size=10mm},
        ]
        \draw node at (0,1.6)   {Identificador};
        \draw node at (7.5, 1.6)  {Atributo};

        \node[ID]   (var1)                  {var1};
        \node[ID]   (Big)   [below=of var1] {Big};

        \node[ATT]  (str1)  [right=of var1]  {str, val:"chungus", esMutable:false};
        \node[ATT]  (int1)  [right=of Big]   {int, val:"12",      esMutable:false};

        \draw[->, very thick] (var1.east) to (str1.west);
        \draw[->, very thick] (Big.east) to (int1.west);

        \node[draw=black, thick, fit={(var1) (Big)}, inner sep=10pt] (box) {};
        \node[draw=black, thick, fit={(str1) (int1)}, inner sep=10pt] (box) {};
    \end{tikzpicture}
    \label{fig: tablaDeSimbolos}
    \caption{Tabla de símbolos implementada como un diccionario}
\end{figure}

\section{Implementación del Analizador Léxico}


Como se ha mencionado anteriormente, la implementación lexica del proyecto fue inspirada por la implementación de Calc++ por bwasti y adaptada para la gramática de AVISMO \cite{wasti_bwastibison-example-calc-_2020}. 

Para compilar el programa, primero que todo se tiene que ejecutar \textit{make clean} por la línea dentro del directorio \textit{code}, Esto se hace con el propósito de evitar errores de compilación.
Entonces, se ejecuta el comando \textit{make}, estó compilará todas las dependencias necesarias, en particular, los archivos de contiene el léxico de Flex (con todos los archivos con extensión .cc, .hh y .ll).
Además, el comando anterior compila todos los programas en código objeto (.o) que se crean para el programa \textit{driver} (el cual está encargado de abrir archivos de entrada e instanciar el analizador), parser y scanner.
Posterior a esto es que se puede ejecutar \textit{./avismo fileName.txt} el cual para nuestro caso seria el siguiente: 

\begin{center}
\textbf{\textit{./avismo test\_prog.txt}}
\end{center}

Al ejecutarse el comando anterior, el programa se encargara de leer \textbf{cada caracter} del programa e identificar si una serie de caracteres sigue un patrón que forma parte del lenguaje AVISMO. Al encontrar un patrón reconocido, tales como un identificador o modelo molecular, lo clasica con un \textit{token} correspondiente, lo emprime en el archivo de \textit{output.txt} y lo devuelve al analizador sintáctico. Note, que el patrón de identificador reconoce a las palabra reservadas. Esto crea ambiguedad semántica debido a que la gramatica no tiene un mecanismo para diferenciar entre una palabra reservada y un identificador. Por esto, si una serie de caracteres si identifica como un lexema de categoría identificador, se compara con los valores dentro del diccionario \textit{variables}, el cual es un miembro de la clase \textit{driver}. Al inicializar un objeto \textit{driver}, cuyo constructor está localizado en \textit{driver.cc} este se encarga de abrir el archivo de
palabras reservadas (\textit{keywords.txt}) y añadir las palabras reservadas antes que cualquier variable se pueda inicializar. Mas aún, a las palabras reservada se le asigna el valor de la cadena vacía. Esto se hace con el propósito de poder diferenciar entre palabras reservadas e identificadores, ya que al nivél sintáctico, no es posible asignarle a una identifcador una cadena vacía.

%Aqui entonces verifica las definiciones de la gramatica, las cuales
%determinan su tipo y los patrones de caracteres que se aceptaran y tokenizan. En nuestro caso, tenemos como ejemplo token <std::string> FIN\_DE\_LINEA "fin\_de\_linea"
%donde se especifica que es un token tipo string el cual se denota como FIN\_DE\_LINEA (determina que ya la sentencia se acabo) fin\_de\_linea es cómo se identifica
%en la expresión regular de cómo el programa se ejecuta.

%El programa mismo necesita un patrón lógico para su ejecución, el cual definimos en base a la gramatica cómo:


%\%\%


%\%start unit;


%unit: exps {};


%exps: \%empty | exps exp {};


%////assignment: "identificador" "="


%exp:
%"fin\_de\_linea" {}
%| "letra" {}
%| "digito" {}
%| "tipo" {}
%| "operacion" {}
%| "valencia" {}
%| "enlace" {}
%| "palabra\_reservada" {}
%| "id" {}
%| "idcont" {}
%| "sentencias" {}
%| "sentencia" {}
%| "modelo\_molecular" {}
%| "compuesto" {}
%| "compuestos" {}
%| "elemento" {}
%| "elemento\_quimico" {}
%| "grupo\_funcional" {}
%| "grupo\_funcional\_inferior" {}
%| "grupo\_funcional\_superior" {}
%| "modelo\_grupo\_funcional" {}\\
%\%\%

%\newpage
%El formato del programa debe seguir este patron donde se empieza con el axioma \textit{unit}, el cual esta compuesto por \textit{exps{}} (expresiones) el cual
%se contiene a si mismo (definición recursiva) y a \textit{exp} (expresión), la cual esta compuesta por todos los tipos de tokens que podemos identificar
Con el propósito de visualizar los lexemas generados por el scanner, colocado en el archivo \textit{scanner.ll}, se utliza la siguiente función:
\begin{lstlisting}
std::ofstream& file("output.txt");
void format_output (std::string token,const char* yytext, yy::location& loc) {
    file << "(" << "<" << token << ">," << std::string(yytext) << "," << loc << ")" << std::endl;
}
\end{lstlisting}
En el caso de un error léxico, se ejecuta el siguiente código:
\begin{lstlisting}
. {
  file << "CARACTER INVALIDO " << std::string(yytext) << "," << loc << std::endl;
}
\end{lstlisting}
Las definiciones que utilizamos para este archivo \textit{scanner.ll} son las mismas que fueron presentadas en la sección anterior 2.1 Gramatica del Lenguaje avismo
pero es en este archivo que damos la definición de qué cada función ejecutará una vez tenga estos lexemas que siguen el patrón establecido (tokenizados). Se utilizara
una variable llamada loc que contiene la referencia a memoria de la variable localización de la clase driver, el cual usaremos para retornar el valor de la linea en
donde encontramos un lexema dado. Tambien esta función devuelve tanto el nombre del token que se categoriza, y su valor como se envia al parser como yytext (contiene el valor del lexema);
todos estos valores como arguments para especificar el formato que queremos el archivo de salida (\textit{output.txt}):


format\_output("SENTENCIAS",yytext,loc);


Todas las definiciones (excepto \textbf{ID}) contienen la función de format\_output para la salida de nuestro programa y siempre devuelven una función que se
utilizara en el parser (que Flex y Bison se encargan en crear por nosotros) para crear una instancia del token.

\begin{lstlisting}
{SENTENCIAS} {
    format_output("SENTENCIAS",yytext,loc);\\
    return yy::parser::make_SENTENCIAS(yytext,loc);\\
}
\end{lstlisting}

En el caso de \textbf{ID}, hay que hacer una diferenciación entre si es una palabra reservada o si es un identificador, pues si no se pone una restricción el programa
no pudiera saber cual caso seria. Para eso se crea un archivo \textit{keywords.txt} el cual contiene estas palabras reservadas los cuales se cargan con el
programa driver. En el caso de que el valor del lexema que esta en "variables" en la clase de drv (driver, la cual contiene el lexema que se esta leyendo) resulta ser
el mismo valor que yytext (el cual contiene el lexema retornado del patrón reconocido) y cuyo texto se encuentra en la lista y su valor es vacio (se sabe por cómo se llena
las palabras a driver al momento de ejecutar el constructor), sabemos entonces que cumple con todos los requisitos de ser una palabra reservada en el contexto del programa.
De no ser el caso, pues entonces no hay otra opción que ser un identificador.

\begin{lstlisting}
{ID} {	
  std::string text(yytext);
  if (drv.variables.find(text) != drv.variables.end() && drv.variables[text] == "") {
    if (drv.variables[text] == "") {
      format_output("PALABRA_RESERVADA",yytext,loc);
      return yy::parser::make_PALABRA_RESERVADA (yytext,loc);
    }
  }
	format_output("ID",yytext,loc);
	return yy::parser::make\_ID(text,loc);
}
\end{lstlisting}